<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Acme PHP | Documentation</title>

    <link href="/fonts/fonts.css" rel="stylesheet">
    <link href="/icons/css/font-awesome.min.css" rel="stylesheet">
    <link href="/min/app.css" rel="stylesheet">

    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.4.0/styles/default.min.css">

    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>
<body>
<header class="header">
    <div class="container">
        <h1 class="header-title">
            <a href="/">Acme PHP</a>
        </h1>

        <nav class="header-menu">
            <ul>
                <li class="current">
                    <a href="/documentation/">
                        Documentation
                    </a>
                </li>
                <li>
                    <a href="https://github.com/acmephp/acmephp">
                        Github
                    </a>
                </li>
            </ul>
        </nav>
    </div>
</header>

<main class="doc-page">
    <div class="container">
        <div class="doc-menu">
            <nav role="navigation">
                <ul class="doc-menu-list">
                                        <li>
                        <h4 class="doc-menu-header">Getting started</h4>

                        <ul class="doc-menu-sub">
                                                            <li class="">
                                    <a href="/getting-started/1-installation.html">
                                        1. Installation
                                    </a>
                                </li>
                                                            <li class="">
                                    <a href="/getting-started/2-obtain-certificate-easy.html">
                                        2. Obtain a certificate
                                    </a>
                                </li>
                                                            <li class="">
                                    <a href="/getting-started/3-configure-webserver.html">
                                        3. Configure your webserver
                                    </a>
                                </li>
                                                            <li class="current">
                                    <a href="/getting-started/4-automatic-renewal.html">
                                        4. Setup automatic renewal
                                    </a>
                                </li>
                                                    </ul>
                    </li>
                                        <li>
                        <h4 class="doc-menu-header">Guides</h4>

                        <ul class="doc-menu-sub">
                                                            <li class="">
                                    <a href="/guides/multidomain-certificates.html">
                                        Multi-domain certificates
                                    </a>
                                </li>
                                                            <li class="">
                                    <a href="/guides/dns-challenge.html">
                                        Prove you own a domain using DNS
                                    </a>
                                </li>
                                                    </ul>
                    </li>
                                        <li>
                        <h4 class="doc-menu-header">ACME protocol implementation</h4>

                        <ul class="doc-menu-sub">
                                                            <li class="">
                                    <a href="/core/introduction.html">
                                        Introduction
                                    </a>
                                </li>
                                                            <li class="">
                                    <a href="/core/get-started.html">
                                        Get started
                                    </a>
                                </li>
                                                    </ul>
                    </li>
                                        <li>
                        <h4 class="doc-menu-header">SSL library</h4>

                        <ul class="doc-menu-sub">
                                                            <li class="">
                                    <a href="/ssl/introduction.html">
                                        Introduction
                                    </a>
                                </li>
                                                            <li class="">
                                    <a href="/ssl/get-started.html">
                                        Get started
                                    </a>
                                </li>
                                                    </ul>
                    </li>
                                    </ul>
            </nav>
        </div>

        <div class="doc-content">
            <div class="doc-edit">
                <a href="https://github.com/acmephp/documentation">
                    <i class="fa fa-github"></i>
                    <span>Edit on Github</span>
                </a>
            </div>

            <h1 id="setup-automatic-renewal-with-monitoring">Setup automatic renewal with monitoring</h1>
<p>An awesome feature coming with Let's Encrypt automation is the possibility of automatically renew your certificates.
Acme PHP was built from the beginning with the idea to be easy to put in a CRON.</p>
<h2 id="create-the-cron">Create the CRON</h2>
<p>The easiest part is to create the CRON.</p>
<p>Acme PHP is smart enough to know when to renew a certificate: you don't need to think carefully when to schedule your
CRON task, simply run it every day and Acme PHP will check if the certificate needs renewal.</p>
<p><strong>Note:</strong> a vast majority of webservers requires a restart or a reload after a certificate update, therefore you
should run your CRON as root. You can also create two separate CRON if you don't want to execute Acme PHP as root.</p>
<p>Here is an example:</p>
<pre><code>0 0 * * * php /home/youruser/acmephp.phar request yourdomain.org &gt;/dev/null 2&gt;&amp;1 &amp;&amp; service nginx reload</code></pre>
<p>You may also want to save the output to a log file (note that monitoring is much more powerful though):</p>
<pre><code>0 0 * * * php /home/youruser/acmephp.phar request yourdomain.org &gt;&gt; /var/log/acmephp.log &amp;&amp; service nginx reload</code></pre>
<h2 id="configure-monitoring">Configure monitoring</h2>
<p>A very powerful feature of Acme PHP is monitoring: the CLI client will warn you when a renewal failed. Different
alerts are available, such as e-mail or Slack.</p>
<p>To enable monitoring, you need to edit the Acme PHP configuration file (<code>~/.acmephp/acmephp.conf</code>):</p>
<pre><code class="language-yaml">###################################################################
# Monitoring
#
# This section let you configure a simple monitoring mechanism that
# will warn you if an error occurs during a CRON job.
#

monitoring: ~   # Monitoring is disabled by default

# You can enabled it by configuring at least one alert handler.
# You can change the default handler level to decide when to be alerted
# (only when an error occurs or every time the CRON is started).
#monitoring:
#    email:   # Only SMTP(S) support for now
#        to: galopintitouan@gmail.com
#        host: smtp.example.com
#        # port: 25
#        # username: ~
#        # password: ~
#        # encryption: ~
#        # subject: An error occured during Acme PHP CRON renewal
#        # level: error     # By default, only on error for email handler
#
#    slack:
#        token: your_token
#        channel: #general
#        # username: Acme PHP
#        # level: info      # By default, on every CRON for slack handler</code></pre>
<p>This configuration is quite straight-forward: simply remove the <code>monitoring: ~</code> line, uncomment the monitoring part
and edit it to your needs.</p>
<p>Note that there are two levels for monitoring alert handlers:</p>
<ul>
<li><em>info</em> level means that the handler will be triggered at every renewal, even if it succeeded ;</li>
<li><em>error</em> level means that the handler will be triggered only if an error occurs during renewal ;</li>
</ul>
        </div>

        <div class="clearfix"></div>
    </div>
</main>

<footer class="footer">
    <div class="container">
        <nav>
            <ul>
                <li class="footer-column">
                    <h5>
                        Documentation
                    </h5>

                    <ul>
                        <li>
                            <a href="/documentation/">Command line tool</a>
                        </li>
                        <li>
                            <a href="/documentation/core/introduction.html">Acme PHP library</a>
                        </li>
                        <li>
                            <a href="/documentation/ssl/introduction.html">SSL library</a>
                        </li>
                    </ul>
                </li>
                <li class="footer-column">
                    <h5>
                        Contribute
                    </h5>

                    <ul>
                        <li>
                            <a href="https://github.com/acmephp/acmephp">Github repository</a>
                        </li>
                        <li>
                            <a href="https://github.com/acmephp/acmephp/issues">Issues tracker</a>
                        </li>
                        <li>
                            <a href="https://github.com/acmephp/documentation">Improve documentation</a>
                        </li>
                    </ul>
                </li>
                <li class="footer-column">
                    <h5>
                        Connect
                    </h5>

                    <ul>
                        <li>
                            <a href="https://gitter.im/acmephp/acmephp">Gitter</a>
                        </li>
                        <li>
                            <a href="https://twitter.com/acme_php">Twitter</a>
                        </li>
                        <li>
                            <a href="https://github.com/acmephp/acmephp">Github</a>
                        </li>
                    </ul>
                </li>
                <li class="footer-column">
                    <h5>
                        About
                    </h5>

                    <ul>
                        <li>
                            © 2016 Titouan Galopin. All Rights Reserved.
                        </li>
                        <li>
                            Acme PHP is built by
                            <a href="https://twitter.com/titouangalopin">@tgalopin</a> and
                            <a href="https://twitter.com/jderusse">@jderusse</a>
                        </li>
                        <li>
                            Acme PHP source code and documentation are free and open-source under the
                            MIT license
                        </li>
                    </ul>
                </li>
            </ul>
        </nav>

        <div class="clearfix"></div>
    </div>
</footer>

<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.4.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-79502600-1', 'auto');
    ga('send', 'pageview');

    (function(h,o,t,j,a,r){
        h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
        h._hjSettings={hjid:233364,hjsv:5};
        a=o.getElementsByTagName('head')[0];
        r=o.createElement('script');r.async=1;
        r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
        a.appendChild(r);
    })(window,document,'//static.hotjar.com/c/hotjar-','.js?sv=');
</script>
        <!-- Livereload -->
        <script>
            document.write('<script src="http://' + (location.host || 'localhost').split(':')[0] +
                    ':35729/livereload.js?snipver=1"></' + 'script>')
        </script>
        <!-- End Livereload -->
    </body>
</html>
